import duckdb
import matplotlib.pyplot as plt

# Подключаемся к БД
conn = duckdb.connect("taxi_data.duckdb")

# Загружаем агрегированные данные
df = conn.execute("SELECT * FROM taxi_aggregates ORDER BY interval_10min").fetchdf()
conn.close()

print("✅ Loaded aggregated data:")
print(df.head())

# --- Визуализация ---
plt.figure(figsize=(10, 5))
plt.plot(df["interval_10min"], df["total_points"], label="Total Points", marker="o")
plt.plot(df["interval_10min"], df["unique_taxis"], label="Unique Taxis", marker="x")

plt.title("Taxi Activity (every 10 minutes)")
plt.xlabel("Time Interval")
plt.ylabel("Count")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.show()
